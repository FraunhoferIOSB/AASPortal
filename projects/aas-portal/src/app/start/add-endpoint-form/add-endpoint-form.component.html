<!-----------------------------------------------------------------------------
 !
 ! Copyright (c) 2019-2024 Fraunhofer IOSB-INA Lemgo,
 ! eine rechtlich nicht selbstaendige Einrichtung der Fraunhofer-Gesellschaft
 ! zur Foerderung der angewandten Forschung e.V.
 !
 !---------------------------------------------------------------------------->

<form (ngSubmit)="submit()">
    <div class="modal-header text-info">
        <h4 class="modal-title">
            <i class="bi bi-plus-circle"></i>
            <span class="ms-2" translate>CAPTION_ADD_ENDPOINT</span>
        </h4>
        <button type="button" class="btn-close" (click)="cancel()"> </button>
    </div>
    <div class="modal-body">
        @for (message of messages(); track message) {
        <ngb-toast [autohide]="false" class="bg-danger w-100 mb-3">
            <div class="d-flex">
                <div class="flex-grow-1">{{ message }}</div>
            </div>
        </ngb-toast>
        }
        <label class="form-lable" for="input-endpoint-name" translate>AddEndpointForm.LABEL_NAME</label>
        <input id="input-endpoint-name" type="text" class="form-control mb-3"
            placeholder="{{'AddEndpointForm.PLACEHOLDER_NAME' | translate}}" [(ngModel)]="name" name="name"
            (input)="inputValue()">
        <label class="form-lable" for="div-endpoint-url" translate>AddEndpointForm.LABEL_URL</label>
        <div class="input-group" ngbDropdown role="group" id="div-endpoint-url">
            <button type="button" class="btn btn-secondary" ngbDropdownToggle>{{'AddEndpointForm.' + selectedItem().type
                |
                translate}}</button>
            <div class="dropdown-menu" ngbDropdownMenu>
                @for (item of items(); track item) {
                <button type="button" (click)="selectItem(item)" ngbDropdownItem>{{'AddEndpointForm.' + item.type |
                    translate}}</button>
                }
            </div>
            <input id="input-endpoint-url" type="text" class="form-control"
                placeholder="{{selectedItem().placeholder | translate}}" [(ngModel)]="selectedItem().value" name="value"
                (input)="inputValue()">
        </div>
        @if (selectedItem().type === 'AAS_API') {
        <div class="col-12 mt-2" style="max-height: 200px; overflow-y: auto;">
            <table class="table table-sm table-striped table-borderless">
                <thead>
                    <tr>
                        <th scope="col" class="text-center" [style.width]="'32px'">#</th>
                        <th scope="col" class="text-center">Header</th>
                        <th scope="col" class="text-center">Value</th>
                    </tr>
                </thead>
                <tbody>
                    @for (header of headers(); track header.id) {
                    <tr>
                        <th scope="row" (click)="selectHeader(header)">{{header.id}}</th>
                        @if (header === selectedHeader()) {
                        <td>
                            <input type="text" class="form-control form-control-sm" [(ngModel)]="header.name"
                                placeholder="header name" name="headerName" />
                        </td>
                        <td>
                            <input type="text" class="form-control form-control-sm" [(ngModel)]="header.value"
                                placeholder="value" name="headerValue" />
                        </td>
                        } @else {
                        <td  (click)="selectHeader(header)">
                            <div class="small">{{header.name}}</div>
                        </td>
                        <td  (click)="selectHeader(header)">
                            <div class="small">{{header.value}}</div>
                        </td>
                        }
                        }
                </tbody>
            </table>
        </div>
        }
    </div>
    <div class="modal-footer">
        <button type="submit" class="btn btn-primary" translate>CMD_OK</button>
        <button type="button" class="btn btn-secondary" (click)="cancel()" translate>CMD_CANCEL</button>
    </div>
</form>